create database healthcare_analysis;

select * 
from healthcare_dataset;

-- Demographics & Patients:
-- What is the average age of patients admitted?


select age,avg(age) as avg_age
from healthcare_dataset
group by age limit 10;

-- What is the gender distribution of the patients?
select Gender, count(*) as patient_count
from healthcare_dataset
group by gender;

-- What are the most common medical conditions?
select count(*) as condition_count,`Medical Condition`
from healthcare_dataset
group by `Medical Condition`
order by condition_count DESC limit 5;

-- Which blood types are more prevalent among patients? 
select `Blood Type`, count(*) as prevalent_bloodtypes
from healthcare_dataset
group by `Blood Type`;

-- Which hospital has the highest number of admissions?
select Hospital, count(*) as admission_count
from healthcare_dataset
group by Hospital
order by admission_count desc limit 5; 

-- What is the average length of stay for each hospital or condition?
select Hospital, avg(datediff(`Discharge Date`,`Date of Admission`)) as avg_stay
from healthcare_dataset
group by Hospital
order by avg_stay desc limit 5;

-- Length of stay by medical condition
select `Medical Condition`, avg(datediff(`Discharge Date`,`Date of Admission`)) as avg_stay
from healthcare_dataset
group by `Medical Condition`;

-- What is the average billing amount per patient?
select avg(`Billing Amount`) as avg_billing_amount
from healthcare_dataset;

-- How does the billing vary by insurance provider?
select `Insurance Provider`, avg(`Billing Amount`) as avg_billing_amount
from healthcare_dataset
group by `Insurance Provider`;

-- What is the total revenue generated by each hospital?
select Hospital, sum(`Billing Amount`) as total_revenue
from healthcare_dataset
group by Hospital
order by total_revenue DESC limit 1;

-- What is the most prescribed medication?
select Medication, count(*) as most_prescirbed
from healthcare_dataset
group by Medication
order by most_prescirbed DESC limit 5;

-- Which medical conditions show abnormal test results?
select `Medical Condition`, count(*) as Abnormal_Count
from healthcare_dataset
where `Test Results` = "Abnormal"
group by `Medical Condition`
order by Abnormal_Count DESC;













